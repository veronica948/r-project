# Лабораторная работа №4

#### Упражнение 1

Данное упражнение основано на данных `Carseats` из библиотеки `ISLR`.

(a) Постройте множественную линейную регрессионную модель, которая будет предсказывать значение переменной `Sales` используя переменные `Price`, `Urban` и `US`.

(b) Проинтерпретируйте каждый коэффициент модели. Будьте внимательны: модель содержит качественные и количественные переменные.

(c) Выпишите уравнение, соответствующее данной модели.

(d) Для каких предикторов можно отвергнуть нулевую гипотезу `H_0: beta_j = 0`?

(e) На основании ответа на предыдущий вопрос постройте меньшую модель, которая будет использовать только те предикторы, для которых имеет место связь с переменной отклика.

(f) Насколько хорошо модели из пунктов (a) и (e) соответствуют данным?

(g) Используя модель из пункта (e), получите 95% доверительные интервалы для коэффициентов.

(h) Можно ли сказать, что в модели из пункта (e) среди данных есть выбросы (outliers) или наблюдения с высоким влиянием (leverage points)?

#### Упраженение №2

Данное упражнение сфокусировано на проблеме *коллинеарности*.

(a) Выполните следующие команды в `R`:

```{r, eval=FALSE}
set.seed(1)
x1 = runif(100)
x2 = 0.5*x1 + rnorm(100)/10
y = 2 + 2*x1 + 0.3 *x2 + rnorm(100)

```

Последняя строчка соответствует линейной модели, в которой `y` является функцией от `x1` и `x2`. Выпишите уравнение, которое соответствует данной модели. Каковы регрессионные коэффициенты?

(b) Какова корреляция между `x1` и `x2`. Постройте точечную диаграмму отображающую связь между данными переменными.

(c) Используя эти данные постройте линейную регрессиионную модель, которая будет предсказывать значение переменной `y` по значениям переменных `x1` и `x2`. Опишите полученные результаты. Каковы оценки для коэффициентов `beta0`, `beta1` и `beta2`? Как они соотносятся с истинными значениями коэффициентов? Можете ли вы отвергнуть нулевую гипотезу `H_0: beta1 = 0`? А нулевую гипотезу `H_0: beta2 = 0`?

(d) Постройте линейную регрессионную модель, которая будет предсказывать значение переменной `y` только по значению переменной `x1`. Прокомментируйте ваши результаты. Можете ли вы отвергнуть нулевую гипотезу `H_0: beta1 = 0`?

(e) Постройте линейную регрессионную модель, которая будет предсказывать значение переменной `y` только по значению переменной `x2`. Прокомментируйте ваши результаты. Можете ли вы отвергнуть нулевую гипотезу `H_0: beta1 = 0`?

(f) Противоречат ли результаты, полученные в пунктах (c) - (e) друг другу? Объясните ваш ответ.

(g) Предположим, что мы получили еще одно дополнительное наблюдение.

```{r, eval=FALSE}
x1 = c(x1, 0.1)
x2 = c(x2, 0.8)
y = c(y, 6)
```

Перестройте модели из пунктов (с) - (e) используя новые данные. Какой эффект оказывает новое наблюдение на каждую из этих моделей? Для каждой модели будет ли это наблюдение выбросом? Наблюдением с высоким влиянием? Объясните ваш ответ.

